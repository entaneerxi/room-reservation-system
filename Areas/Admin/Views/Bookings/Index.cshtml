@model IEnumerable<RoomReservationSystem.Models.Booking>
@{
    ViewData["Title"] = "จัดการการจอง";
}

<div class="row mb-3">
    <div class="col-12">
        <div class="btn-group" role="group">
            <a asp-action="Index" class="btn btn-outline-primary @(string.IsNullOrEmpty(ViewBag.SelectedStatus) ? "active" : "")">
                ทั้งหมด
            </a>
            <a asp-action="Index" asp-route-status="Pending" class="btn btn-outline-warning @(ViewBag.SelectedStatus == "Pending" ? "active" : "")">
                รอดำเนินการ
            </a>
            <a asp-action="Index" asp-route-status="Confirmed" class="btn btn-outline-primary @(ViewBag.SelectedStatus == "Confirmed" ? "active" : "")">
                ยืนยันแล้ว
            </a>
            <a asp-action="Index" asp-route-status="CheckedIn" class="btn btn-outline-success @(ViewBag.SelectedStatus == "CheckedIn" ? "active" : "")">
                เช็คอินแล้ว
            </a>
            <a asp-action="Index" asp-route-status="CheckedOut" class="btn btn-outline-secondary @(ViewBag.SelectedStatus == "CheckedOut" ? "active" : "")">
                เช็คเอาท์แล้ว
            </a>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-body p-0">
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>ลูกค้า</th>
                    <th>ห้องพัก</th>
                    <th>วันเข้าพัก</th>
                    <th>วันออก</th>
                    <th>ประเภท</th>
                    <th>ยอดเงิน</th>
                    <th>สถานะ</th>
                    <th>จัดการ</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    @foreach (var booking in Model)
                    {
                        <tr>
                            <td>#@booking.Id</td>
                            <td>@booking.User?.FirstName @booking.User?.LastName</td>
                            <td>@booking.Room?.Name</td>
                            <td>@booking.CheckInDate.ToString("dd/MM/yyyy")</td>
                            <td>@booking.CheckOutDate.ToString("dd/MM/yyyy")</td>
                            <td>
                                @if (booking.BookingType == "Daily")
                                {
                                    <span class="badge badge-info">รายวัน</span>
                                }
                                else
                                {
                                    <span class="badge badge-success">รายเดือน</span>
                                }
                            </td>
                            <td>@booking.TotalAmount.ToString("N0") บาท</td>
                            <td>
                                @switch (booking.Status)
                                {
                                    case "Pending":
                                        <span class="badge badge-warning">รอดำเนินการ</span>
                                        break;
                                    case "Confirmed":
                                        <span class="badge badge-primary">ยืนยันแล้ว</span>
                                        break;
                                    case "CheckedIn":
                                        <span class="badge badge-success">เช็คอินแล้ว</span>
                                        break;
                                    case "CheckedOut":
                                        <span class="badge badge-secondary">เช็คเอาท์แล้ว</span>
                                        break;
                                    case "Cancelled":
                                        <span class="badge badge-danger">ยกเลิก</span>
                                        break;
                                }
                            </td>
                            <td>
                                <a asp-action="Details" asp-route-id="@booking.Id" class="btn btn-sm btn-info">
                                    <i class="fas fa-eye"></i> ดูรายละเอียด
                                </a>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="9" class="text-center">ไม่มีข้อมูล</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
